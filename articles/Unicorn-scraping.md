RのフロントエンドExploratoryで簡単にユニコーン企業のデータをスクレイピングしてきて、分析してみた


##0. 簡単にスクレイピング

![](images/unicorn-webpage.png)
![](images/unicorn-webpage2.png)


実は、このデータは、世界中のユニコーン企業のデータを表しています。
ユニコーン企業というのは、上場していなくて、評価額が１ビリオンドル以上の評価額を得ている企業のことを指します。

どの国がユニコーンが多いのかとか、期間とバリエーションの関係性とか、いつユニコーン企業が多く生まれてるのかって気になったりしませんか？　それをExploratoryを使ってみていくことができるのでやってみます。

##1. 簡単にスクレイピング

![](images/unicorn-scraping.png)

![](images/unicorn-scraping2.png)

![](images/unicorn-scraping3.png)

まず、ここにさっきのリンクを貼るだけでデータをスクレイピングしてこれます。

![](images/unicorn-webpage3.png)

リンクを貼るだけでデータをスクレイピングしてこれました。

![](images/unicorn-scraping4.png)


ここでは、スクレイピングでとってきたWEB上のデータですけど、GitHub、Google Analytics、Google Spread sheet、Mongo DB、MySQL、JSON REST APIなどのたくさんのデータベースから本当に簡単にデータをインポートしてきて分析することも可能です。


##2. 日本にユニコーン企業はいるのか？

カラムの説明。

ビジュアライズ化してみます。

国ごとにユニコーンを出す。
X軸にCountryをいれると、それのヒストグラム、要は、何回でてきたかを表すバーチャートになるんですけど。
日本はどこがユニコーンなのか見てみると、

filter(Country == "Japan")

実は、メルカリだけなんですよね。

##3. データ変更

次に、バリエーションのところがキャラクターになっていて、通貨のサインがはいってるんですよね

このままだと、チャートに行って、X軸をcompany、次にY軸をvalidationにしようにもsumっていう関数が使えないんですよね。countしちゃってるだけなので。テーブルを見ると、＄がついてます。今回は、通貨の記号ですけど、％が入ってたり、円がはいってたり。こういうのってけっこうありますよね。そういうのってけっこう、regular expression とか使いながら地道にとっていけなかったりするんですけど、ぼくたちのツールでは、コマンド１つでいけるんですよ。（興味を惹きつけるように）

要するに、この部分が通貨であれ、何かの記号であれ、数字だけを抜き出してきたいだけですよね？　なので、ナンバーだけのバリエーションという新しいカラムを作ります。新しいカラムを作るときは、mutateコマンドを使います。そういうときは、extract_numericコマンド（ファンクションリストから）を使うと、数字だけを抜き出してくることができます。

そうするときは、extract_numericという関数があります。

mutate( valuation = extract_numeric( valuation…..B.))

（テーブルを見せながら）、ここにめでたいことにダラーを抜いたナンバーだけのカラムができましたね。
もう一回、さっきのチャートに戻って、Y軸をnumberのバリエーションができたのでそちらに変えます。そうすると、今度はsumっていう関数が使えますよね。

で、これがあまりにも数が多すぎてもしょうがないので、top_n()という関数を使って、見てみましょう。

top_n(10, valuation )

これでトップ１０の会社を見たりすることができます。

Date.Joinedは、ユニコーン企業にいつなったか、で、そこから何年たっているかを表しています。ユニコーン企業になって、どれくらいたっているかとそこから今日までのバリエーションを比べてどういう関係性があるのかちょっと見てみたいと思いませんか？

そのために、まずこのDate.JoinのカラムがcharacterになっているのでDateに変えてみましょうと。

なので、ちょっと前のステップに戻ってやってみます。でまず、これをdateにしたいので、また新しいカラムを作りましょう。（ファンクションリストから）で、ここがmonth day yearとなっているのでmdyとします。で、そのあとにこのDate.Joinedというカラムを付け加えます。

top_n(10, valuation )の上に
mutate(date = mdy(Date.Joined)) ってカラムを指定してあげると、テーブルを見せながらDate.Joinedというのができてるんですけど、

これでサマリーを診てもらうと、こういうふうにもともとはcharacterだったのがPOXctというカレンダータイプになっているのでこういうふうにヒストグラムになっているのがわかりますね。

これを今日の日付の2016年から単純にマイナスすると、ユニコーンになってから今日までどれくらいたっているかを表すyears_since_joined という新しいカラムを作りたいと思います。

mutate( years_since_joined = 2016 - year(date))

ですので、これでもう一回チャートのほうに戻ってもらって、今度逆にScatter Plotなんか使って、でXのほうにyearを、で縦軸に、例えばvalidationを渡してもらうと、これでいくつかのdotが出てきましたよね。ここにgroup_byっていうのがあるのでここにcompanyをいれてあげるとそれぞれの会社の情報を見ることが出来ました。

例えば、Uberなんかは約３年かかって５０バリエーションになっていますね

##.

次に、最近ITバブルなんて言われたりしてますけど、ユニコーン企業がどんな感じで増えていってるのかとかって気になったりしませんか？

チャートを見てみますと、いついくつのユニコーン企業が生まれたのかをわかっても、累積されたものとして計算されてないので、どんな感じで増えていってるのかがわかりにくいですよね？なので、合計数が累積されたチャートを作りたいと思います。

そのために、まずdateをグルーピングします。

group_by(date)

これでテーブルviewを見ると、ここにdateでグルーピングされてるのがわかりますね。
次にsummarize関数を使って、グルーピングされたdateごとのユニコーン企業の数を見てみたいと思います。

summarize(count = n())

例えば、これで2012年の12月にユニコーン企業が2社生まれたりしているということがこれでわかりました。

次に、日付でソートしてみましょう。
arrange(date)

cumsum関数というのを使うと、その累積ができるようになります。なので、累積を表したcum_countという新しいカラムを作りたいと思います。

mutate(cum_count = cumsum(count))

これでチャートを見てみると（X軸をdate(day)、Line)、ユニコーン企業が2014年を機にいっきに増えてることがわかったりします。こういう分析って他のツールだと難しいですよね。

##. Note



